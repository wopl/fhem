###############################################################################
#                                                                             #
# fhem_sps_devices.cfg                             Wolfram Plettscher 05/2016 #
# included into fhem_main.cfg                                                 #
#                                                                             #
# communicate with Wago SPS devices                                           #
#                                                                             #
###############################################################################

###############################################################################
### Schminkspiegel
define Schminkspiegel dummy
attr Schminkspiegel room Licht,Bad
attr Schminkspiegel group Licht
attr Schminkspiegel webCmd on:off

define actOn_Schminkspiegel_On notify Schminkspiegel.on \
  set Wago880 schminkspiegel_trigger 0;; \
  set Wago880 schminkspiegel_data 1;; \
  set Wago880 schminkspiegel_trigger 1;; \
  sleep 0.1;; set Wago880 schminkspiegel_trigger 0;;

define actOn_Schminkspiegel_Off notify Schminkspiegel.off \
  set Wago880 schminkspiegel_trigger 0;; \
  set Wago880 schminkspiegel_data 0;; \
  set Wago880 schminkspiegel_trigger 1;; \
  sleep 0.1;; set Wago880 schminkspiegel_trigger 0;;


###############################################################################
### Dimmer Spiegel Bad
define Dimmer_Spiegel_Bad dummy
attr Dimmer_Spiegel_Bad room Licht,Bad
attr Dimmer_Spiegel_Bad group Licht
attr Dimmer_Spiegel_Bad webCmd off:25:50:on
attr Dimmer_Spiegel_Bad eventMap /off:0/25:25/50:50/on:85/

define actOn_SpiegelBad_Val notify Dimmer_Spiegel_Bad.* \
  set Wago880 spiegelbad_trigger 0;; \
  set Wago880 spiegelbad_data $EVENT;; \
  set Wago880 spiegelbad_trigger 1;; \
  sleep 3;; set Wago880 spiegelbad_trigger 0;;

###############################################################################
### Dimmer Luftraum (currently switch only)
#define Dimmer_Luftraum dummy
#attr Dimmer_Luftraum room Licht,Eingang
#attr Dimmer_Luftraum group Licht
#attr Dimmer_Luftraum webCmd on:off
#
#define actOn_Dimmer_Luftraum_On notify Dimmer_Luftraum.on \
#  set Wago880 coil2_w 0;; \
#  set Wago880 coil1_w 1;; \
#  set Wago880 coil2_w 1;; \
#  sleep 0.1;; set Wago880 coil2_w 0;;
#
#define actOn_Dimmer_Luftraum_Off notify Dimmer_Luftraum.off \
#  set Wago880 coil2_w 0;; \
#  set Wago880 coil1_w 0;; \
#  set Wago880 coil2_w 1;; \
#  sleep 0.1;; set Wago880 coil2_w 0;;
#
#define actOn_Wago880_coil1 notify Wago880:coil1_r.* { \
#  if (ReadingsVal ("Wago880", "coil1_r", "1")) { \
#    fhem (" \
#       set Dimmer_Luftraum on \
#    ") \
#  } else { \
#    fhem (" \
#       set Dimmer_Luftraum off \
#    ") \
#  } \
#}

###############################################################################
### Dimmer __test to build Wago SPS Dimmer
#define Dimmer__test dummy
#attr Dimmer__test room Licht,Eingang
#attr Dimmer__test group Licht
#attr Dimmer__test webCmd 0:25:50:100

#define actOn_Dimmer__test_off notify Dimmer__test.off \
#  set Wago881 coil2_w 0;; \
#  set Wago881 word1_w 0;; \
#  set Wago881 coil2_w 1;; \
#  sleep 3;; set Wago881 coil2_w 0;;

#define actOn_Dimmer__test_50 notify Dimmer__test.* \
#  set Wago881 coil2_w 0;; \
#  set Wago881 word1_w $EVENT;; \
#  set Wago881 coil2_w 1;; \
#  sleep 3;; set Wago881 coil2_w 0;;

